<!doctype html>














<!-- `site.alt_lang` can specify a language different from the UI -->
<html lang="en" data-mode="dark">
  <head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7">
  <meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e">
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta
    name="viewport"
    content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover"
  ><!-- Setup Open Graph image -->

  

  <!-- Begin Jekyll SEO tag v2.8.0 -->
<meta name="generator" content="Jekyll v4.4.1" />
<meta property="og:title" content="DBatLoader - Malware Analysis Walkthrough" />
<meta property="og:locale" content="en" />
<meta name="description" content="This is my “first” report/summary/walkthrough post, it’s very rough unpolished and with comments/notes of what I noted while I was working on the file. Still I wanted to post it so I can show snippet of what I’m doing aaand hopefully soon enough I will finish this analysis and report." />
<meta property="og:description" content="This is my “first” report/summary/walkthrough post, it’s very rough unpolished and with comments/notes of what I noted while I was working on the file. Still I wanted to post it so I can show snippet of what I’m doing aaand hopefully soon enough I will finish this analysis and report." />
<link rel="canonical" href="http://localhost:4000/posts/DBatLoader/" />
<meta property="og:url" content="http://localhost:4000/posts/DBatLoader/" />
<meta property="og:site_name" content="Qba01" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2025-07-17T00:00:00+02:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="DBatLoader - Malware Analysis Walkthrough" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2025-07-17T00:00:00+02:00","datePublished":"2025-07-17T00:00:00+02:00","description":"This is my “first” report/summary/walkthrough post, it’s very rough unpolished and with comments/notes of what I noted while I was working on the file. Still I wanted to post it so I can show snippet of what I’m doing aaand hopefully soon enough I will finish this analysis and report.","headline":"DBatLoader - Malware Analysis Walkthrough","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/posts/DBatLoader/"},"url":"http://localhost:4000/posts/DBatLoader/"}</script>
<!-- End Jekyll SEO tag -->


  <title>DBatLoader - Malware Analysis Walkthrough | Qba01
  </title>

  <!--
  The Favicons for Web, Android, Microsoft, and iOS (iPhone and iPad) Apps
  Generated by: https://realfavicongenerator.net/
-->



<link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png">

  <link rel="manifest" href="/assets/img/favicons/site.webmanifest">

<link rel="shortcut icon" href="/assets/img/favicons/favicon.ico">
<meta name="apple-mobile-web-app-title" content="Qba01">
<meta name="application-name" content="Qba01">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml">
<meta name="theme-color" content="#ffffff">


  <!-- Resource Hints -->
  
    
      
        <link rel="preconnect" href="https://fonts.googleapis.com" >
      
        <link rel="dns-prefetch" href="https://fonts.googleapis.com" >
      
    
      
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
      
        <link rel="dns-prefetch" href="https://fonts.gstatic.com" >
      
    
      
        <link rel="preconnect" href="https://cdn.jsdelivr.net" >
      
        <link rel="dns-prefetch" href="https://cdn.jsdelivr.net" >
      
    
  

  <!-- Bootstrap -->
  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.6/dist/css/bootstrap.min.css">
  

  <!-- Theme style -->
  <link rel="stylesheet" href="/assets/css/jekyll-theme-chirpy.css">

  <!-- Web Font -->
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400&family=Source+Sans+Pro:wght@400;600;700;900&display=swap">

  <!-- Font Awesome Icons -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.7.1/css/all.min.css">

  <!-- 3rd-party Dependencies -->

  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.32.2/dist/tocbot.min.css">
  

  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.min.css">
  

  
    <!-- Image Popup -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/glightbox@3.3.0/dist/css/glightbox.min.css">
  

  <!-- Scripts -->

  <script src="/assets/js/dist/theme.min.js"></script>

  <!-- JS selector for site. -->

<!-- commons -->



<!-- layout specified -->


  

  
    <!-- image lazy-loading & popup & clipboard -->
    
  















  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  



  <script defer src="https://cdn.jsdelivr.net/combine/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js,npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.umd.min.js,npm/glightbox@3.3.0/dist/js/glightbox.min.js,npm/clipboard@2.0.11/dist/clipboard.min.js,npm/dayjs@1.11.13/dayjs.min.js,npm/dayjs@1.11.13/locale/en.js,npm/dayjs@1.11.13/plugin/relativeTime.js,npm/dayjs@1.11.13/plugin/localizedFormat.js,npm/tocbot@4.32.2/dist/tocbot.min.js"></script>







<script defer src="/assets/js/dist/post.min.js"></script>



<!-- Pageviews -->

  

  



  

  <!-- A placeholder to allow defining custom metadata -->

</head>


  <body>
    <!-- The Side Bar -->

<aside aria-label="Sidebar" id="sidebar" class="d-flex flex-column align-items-end">
  <header class="profile-wrapper">
    <a href="/" id="avatar" class="rounded-circle"><img src="/assets/img/favicons/web-app-manifest-512x512.png" width="112" height="112" alt="avatar" onerror="this.style.display='none'"></a>

    <a class="site-title d-block" href="/">Qba01</a>
    <p class="site-subtitle fst-italic mb-0">I like RE and malware stuff</p>
  </header>
  <!-- .profile-wrapper -->

  <nav class="flex-column flex-grow-1 w-100 ps-0">
    <ul class="nav">
      <!-- home -->
      <li class="nav-item">
        <a href="/" class="nav-link">
          <i class="fa-fw fas fa-home"></i>
          <span>HOME</span>
        </a>
      </li>
      <!-- the real tabs -->
      
        <li class="nav-item">
          <a href="/categories/" class="nav-link">
            <i class="fa-fw fas fa-stream"></i>
            

            <span>CATEGORIES</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/tags/" class="nav-link">
            <i class="fa-fw fas fa-tags"></i>
            

            <span>TAGS</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/archives/" class="nav-link">
            <i class="fa-fw fas fa-archive"></i>
            

            <span>ARCHIVES</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/about/" class="nav-link">
            <i class="fa-fw fas fa-info-circle"></i>
            

            <span>ABOUT</span>
          </a>
        </li>
        <!-- .nav-item -->
      
    </ul>
  </nav>

  <div class="sidebar-bottom d-flex flex-wrap  align-items-center w-100">
    

    
      

      
        <a
          href="https://github.com/Qba01"
          aria-label="github"
          

          
            target="_blank"
            
          

          

          
            rel="noopener noreferrer"
          
        >
          <i class="fab fa-github"></i>
        </a>
      
    
  </div>
  <!-- .sidebar-bottom -->
</aside>
<!-- #sidebar -->


    <div id="main-wrapper" class="d-flex justify-content-center">
      <div class="container d-flex flex-column px-xxl-5">
        <!-- The Top Bar -->

<header id="topbar-wrapper" class="flex-shrink-0" aria-label="Top Bar">
  <div
    id="topbar"
    class="d-flex align-items-center justify-content-between px-lg-3 h-100"
  >
    <nav id="breadcrumb" aria-label="Breadcrumb">
      

      
        
          
            <span>
              <a href="/">Home</a>
            </span>

          
        
          
        
          
            
              <span>DBatLoader - Malware Analysis Walkthrough</span>
            

          
        
      
    </nav>
    <!-- endof #breadcrumb -->

    <button type="button" id="sidebar-trigger" class="btn btn-link" aria-label="Sidebar">
      <i class="fas fa-bars fa-fw"></i>
    </button>

    <div id="topbar-title">
      Post
    </div>

    <button type="button" id="search-trigger" class="btn btn-link" aria-label="Search">
      <i class="fas fa-search fa-fw"></i>
    </button>

    <search id="search" class="align-items-center ms-3 ms-lg-0">
      <i class="fas fa-search fa-fw"></i>
      <input
        class="form-control"
        id="search-input"
        type="search"
        aria-label="search"
        autocomplete="off"
        placeholder="Search..."
      >
    </search>
    <button type="button" class="btn btn-link text-decoration-none" id="search-cancel">Cancel</button>
  </div>
</header>


        <div class="row flex-grow-1">
          <main aria-label="Main Content" class="col-12 col-lg-11 col-xl-9 px-md-4">
            
              <!-- Refactor the HTML structure -->



<!--
  In order to allow a wide table to scroll horizontally,
  we suround the markdown table with `<div class="table-wrapper">` and `</div>`
-->



<!--
  Fixed kramdown code highlight rendering:
  https://github.com/penibelst/jekyll-compress-html/issues/101
  https://github.com/penibelst/jekyll-compress-html/issues/71#issuecomment-188144901
-->



<!-- Change the icon of checkbox -->



<!-- Handle images -->





<!-- Add header for code snippets -->



<!-- Create heading anchors -->





  
  

  
    
    

    
      
        
        
      

      
      

      
      
      

      
    

    
  

  
  

  
    
    

    
      
        
        
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    

    
  

  
  

  

  
  

  




<!-- return -->










<article class="px-1" data-toc="true">
  <header>
    <h1 data-toc-skip>DBatLoader - Malware Analysis Walkthrough</h1>
    

    <div class="post-meta text-muted">
      <!-- published date -->
      <span>
        Posted
        <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1752703200"
  data-df="ll"
  
    data-bs-toggle="tooltip" data-bs-placement="bottom"
  
>
  Jul 17, 2025
</time>

      </span>

      <!-- lastmod date -->
      

      

      <div class="d-flex justify-content-between">
        <!-- author(s) -->
        <span>
          

          By

          <em>
            
              <a href="https://github.com/Qba01">Qba01</a>
            
          </em>
        </span>

        <div>
          <!-- pageviews -->
          

          <!-- read time -->
          <!-- Calculate the post's reading time, and display the word count in tooltip -->



<!-- words per minute -->










<!-- return element -->
<span
  class="readtime"
  data-bs-toggle="tooltip"
  data-bs-placement="bottom"
  title="989 words"
>
  <em>5 min</em> read</span>

        </div>
      </div>
    </div>
  </header>

  
    <div id="toc-bar" class="d-flex align-items-center justify-content-between invisible">
      <span class="label text-truncate">DBatLoader - Malware Analysis Walkthrough</span>
      <button type="button" class="toc-trigger btn me-1">
        <i class="fa-solid fa-list-ul fa-fw"></i>
      </button>
    </div>

    <button id="toc-solo-trigger" type="button" class="toc-trigger btn btn-outline-secondary btn-sm">
      <span class="label ps-2 pe-1">Contents</span>
      <i class="fa-solid fa-angle-right fa-fw"></i>
    </button>

    <dialog id="toc-popup" class="p-0">
      <div class="header d-flex flex-row align-items-center justify-content-between">
        <div class="label text-truncate py-2 ms-4">DBatLoader - Malware Analysis Walkthrough</div>
        <button id="toc-popup-close" type="button" class="btn mx-1 my-1 opacity-75">
          <i class="fas fa-close"></i>
        </button>
      </div>
      <div id="toc-popup-content" class="px-4 py-3 pb-4"></div>
    </dialog>
  

  <div class="content">
    <blockquote class="prompt-info">
  <p>This is my “first” report/summary/walkthrough post, it’s very rough unpolished and with comments/notes of what I noted while I was working on the file. Still I wanted to post it so I can show snippet of what I’m doing aaand hopefully soon enough I will finish this analysis and report.</p>
</blockquote>

<h3 id="threat-overview"><span class="me-2">Threat Overview</span><a href="#threat-overview" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>
<ul>
  <li><strong>Threat Name</strong>: DBatLoader</li>
  <li>Type Format: #JS</li>
  <li>Hash Values:
    <ul>
      <li>SHA256: e418cbad6006696595a396905ac73ca85eb369ca4ea3afe04619ee88468aeb50</li>
    </ul>
  </li>
  <li><strong>Observations</strong>
    <ul>
      <li>Behavior: [Actions performed by the malware]</li>
      <li>C2 Communication: [Details about command and control servers]</li>
      <li>Persistence Mechanisms: [How the threat maintains its presence]</li>
    </ul>
  </li>
  <li><strong>Attack Vector</strong>:
    <ul>
      <li>Entry Point: [How the threat gains access, e.g., email, compromised website]</li>
      <li>Exploited Vulnerabilities: [Specific vulnerabilities exploited]</li>
    </ul>
  </li>
  <li><strong>Indicators of Compromise (IoCs)</strong>: [List of IoCs, e.g., file hashes, malicious IPs]</li>
</ul>

<h3 id="walkthrough"><span class="me-2">Walkthrough</span><a href="#walkthrough" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>
<p>First of the bat, there is this annoying obfuscation. I saw similar example earlier in different malicious file I was dissecting but I wanted to use it to make an this report/walkthrough thingy, I got stuck and didn’t have much time for the whole thing so I skipped it. And well here we are, now I’m not leaving it like this.
So the unreadable blob might be useless or it’s like this on purpose and can’t be change for the malware to run as the author intended. The values in rounded brackets are probably coordinates of instruction to be read so the code compiles correctly.
![[Pasted image 20250721140043.png]]</p>

<p>The beginning is a slow tidius task, which is what the authors want. 
But so far there are few functions and variables which seem important and it’s a good start. And here is a snippet of them copied and reorganized form the original file.</p>
<div class="language-js highlighter-rouge"><div class="code-header">
        <span data-label-text="JavaScript"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="rouge-code"><pre><span class="kd">function</span> <span class="nf">_0x3e2d</span><span class="p">(</span><span class="nx">_0x5e7335</span><span class="p">,</span><span class="nx">_0x54caa2</span><span class="p">){</span><span class="kd">var</span> <span class="nx">_0x1091ef</span><span class="o">=</span><span class="nf">_0x1091</span><span class="p">();</span><span class="k">return</span> <span class="nx">_0x3e2d</span><span class="o">=</span><span class="kd">function</span><span class="p">(</span><span class="nx">_0x3e2d60</span><span class="p">,</span><span class="nx">_0x460ec8</span><span class="p">){</span><span class="nx">_0x3e2d60</span><span class="o">=</span><span class="nx">_0x3e2d60</span><span class="o">-</span><span class="mh">0x109</span><span class="p">;</span><span class="kd">var</span> <span class="nx">_0x1917f6</span><span class="o">=</span><span class="nx">_0x1091ef</span><span class="p">[</span><span class="nx">_0x3e2d60</span><span class="p">];</span><span class="k">return</span> <span class="nx">_0x1917f6</span><span class="p">;},</span><span class="nf">_0x3e2d</span><span class="p">(</span><span class="nx">_0x5e7335</span><span class="p">,</span><span class="nx">_0x54caa2</span><span class="p">);</span>
<span class="k">catch</span><span class="p">(</span><span class="nx">_0x24b111</span><span class="p">){</span><span class="nx">_0x3c57a9</span><span class="p">[</span><span class="nf">_0x5a110b</span><span class="p">(</span><span class="mh">0x10d</span><span class="p">)](</span><span class="nx">_0x3c57a9</span><span class="p">[</span><span class="nf">_0x5a110b</span><span class="p">(</span><span class="mh">0x128</span><span class="p">)]());}}}(</span><span class="nx">_0x3413</span><span class="p">,</span><span class="mh">0xe300e</span><span class="p">));</span>
<span class="kd">var</span> <span class="nx">_0x358738</span><span class="o">=</span><span class="nf">_0x3413</span><span class="p">();</span><span class="k">return</span> <span class="nx">_0x4813</span><span class="o">=</span><span class="kd">function</span><span class="p">(</span><span class="nx">_0x5be425</span><span class="p">,</span><span class="nx">_0x573a49</span><span class="p">){</span><span class="nx">_0x5be425</span><span class="o">=</span><span class="nx">_0x5be425</span><span class="o">-</span><span class="mh">0xe8</span><span class="p">;</span><span class="kd">var</span> <span class="nx">_0x5774e3</span><span class="o">=</span><span class="nx">_0x358738</span><span class="p">[</span><span class="nx">_0x5be425</span><span class="p">];</span><span class="k">return</span> <span class="nx">_0x5774e3</span><span class="p">;</span>

<span class="kd">function</span> <span class="nf">_0x3413</span><span class="p">(){</span><span class="kd">var</span> <span class="nx">_0x5b81b3</span><span class="o">=</span><span class="nx">_0x3e2d</span><span class="p">,</span><span class="nx">_0x39473b</span><span class="o">=</span><span class="p">[</span><span class="nf">_0x5b81b3</span><span class="p">(</span><span class="mh">0x109</span><span class="p">),</span><span class="nf">_0x5b81b3</span><span class="p">(</span><span class="mh">0x122</span><span class="p">),</span><span class="nf">_0x5b81b3</span><span class="p">(</span><span class="mh">0x140</span><span class="p">),</span><span class="nf">_0x5b81b3</span><span class="p">(</span><span class="mh">0x14e</span><span class="p">),</span><span class="dl">'</span><span class="s1">/^(http(s)?:</span><span class="se">\</span><span class="s1">x5c/</span><span class="se">\</span><span class="s1">x5c/)?</span><span class="dl">'</span><span class="p">,</span><span class="nf">_0x5b81b3</span><span class="p">(</span><span class="mh">0x11d</span><span class="p">),</span><span class="nf">_0x5b81b3</span><span class="p">(</span><span class="mh">0x11c</span><span class="p">),</span><span class="nf">_0x5b81b3</span><span class="p">(</span><span class="mh">0x143</span><span class="p">),</span><span class="nf">_0x5b81b3</span><span class="p">(</span><span class="mh">0x12d</span><span class="p">),</span><span class="nf">_0x5b81b3</span><span class="p">(</span><span class="mh">0x137</span><span class="p">),</span><span class="nf">_0x5b81b3</span><span class="p">(</span><span class="mh">0x125</span><span class="p">),</span><span class="nf">_0x5b81b3</span><span class="p">(</span><span class="mh">0x148</span><span class="p">),</span><span class="nf">_0x5b81b3</span><span class="p">(</span><span class="mh">0x115</span><span class="p">),</span><span class="nf">_0x5b81b3</span><span class="p">(</span><span class="mh">0x13a</span><span class="p">),</span><span class="nf">_0x5b81b3</span><span class="p">(</span><span class="mh">0x123</span><span class="p">),</span><span class="nf">_0x5b81b3</span><span class="p">(</span><span class="mh">0x14a</span><span class="p">),</span><span class="nf">_0x5b81b3</span><span class="p">(</span><span class="mh">0x10f</span><span class="p">),</span><span class="nf">_0x5b81b3</span><span class="p">(</span><span class="mh">0x135</span><span class="p">),</span><span class="nf">_0x5b81b3</span><span class="p">(</span><span class="mh">0x11a</span><span class="p">),</span><span class="nf">_0x5b81b3</span><span class="p">(</span><span class="mh">0x114</span><span class="p">),</span><span class="nf">_0x5b81b3</span><span class="p">(</span><span class="mh">0x13b</span><span class="p">),</span><span class="nf">_0x5b81b3</span><span class="p">(</span><span class="mh">0x150</span><span class="p">),</span><span class="dl">'</span><span class="s1">host</span><span class="dl">'</span><span class="p">,</span><span class="nf">_0x5b81b3</span><span class="p">(</span><span class="mh">0x11f</span><span class="p">),</span><span class="nf">_0x5b81b3</span><span class="p">(</span><span class="mh">0x116</span><span class="p">),</span><span class="dl">'</span><span class="s1">src</span><span class="dl">'</span><span class="p">,</span><span class="nf">_0x5b81b3</span><span class="p">(</span><span class="mh">0x149</span><span class="p">),</span><span class="dl">'</span><span class="s1">attachEvent</span><span class="dl">'</span><span class="p">,</span><span class="nf">_0x5b81b3</span><span class="p">(</span><span class="mh">0x151</span><span class="p">),</span><span class="nf">_0x5b81b3</span><span class="p">(</span><span class="mh">0x10b</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></div></div>

<p>After figuring out which variables and fuctions are important they can be swapped for easier to read or even simplified. All of this is just another way of making analysts life harder and function ABC is often evoking itself.
<code class="language-plaintext highlighter-rouge">_0x3413</code> is an function which returns the main array <code class="language-plaintext highlighter-rouge">_0x39473b</code> with all of the obfuscated commands. I will rename it too <code class="language-plaintext highlighter-rouge">func1</code> because I’m creative
<code class="language-plaintext highlighter-rouge">_0x39473b</code> is an array so now it will be known as <code class="language-plaintext highlighter-rouge">array1</code>
<code class="language-plaintext highlighter-rouge">_0x358738</code> just calls <code class="language-plaintext highlighter-rouge">_0x3413()</code> basically, lets name it <code class="language-plaintext highlighter-rouge">var3</code>
<code class="language-plaintext highlighter-rouge">var _0x5b81b3=_0x3e2d</code> and <code class="language-plaintext highlighter-rouge">_0x3e2d</code> is the first declared function if I didn’t miss any other so maybe <code class="language-plaintext highlighter-rouge">funcFirst</code>. Also we don’t need <code class="language-plaintext highlighter-rouge">_0x5b81b3</code>. But I will keep it for a while just in case if I mess something up.
<code class="language-plaintext highlighter-rouge">var _0x5774e3=_0x358738[_0x5be425]</code> as <code class="language-plaintext highlighter-rouge">var1</code> also it appears only twice so it’s also not important, it’s just an obfuscation.
<code class="language-plaintext highlighter-rouge">_0x5be425</code> is <code class="language-plaintext highlighter-rouge">var2</code>, buuut can’t just replace all of that because it’s also used as a number or some value <code class="language-plaintext highlighter-rouge">_0x5be425=_0x5be425-0xe8</code>.
I found <code class="language-plaintext highlighter-rouge">_0x4813</code> 6 matches for this string, but only half of that it’s important, when it’s used as name for a function, <code class="language-plaintext highlighter-rouge">func3</code>
<code class="language-plaintext highlighter-rouge">_0x5b81b3</code> is <code class="language-plaintext highlighter-rouge">varFunc</code> now</p>

<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre></td><td class="rouge-code"><pre>_0x3e2d - 7 ale tylko 5 ważnych
_0x4813 - 6 ale tylko 4 ważne
_0x3413 - 5 ale tylko 4 ważne
_0x5b81b3 - 49/49
_0x4721 - 4/5
_0x3fcb - 89 but only last 3 
_0x81cfae - 52/52
_0x3ee5e0 - 2/2
_0x25cb6a - 2/2
_0x7d116e - 2/2
_0x5a2079 - 4/4
_0x2cea4d - 2/2
_0x3578b9 - 1/1
_0x39473b - 2/2
_0x1091
</pre></td></tr></tbody></table></code></div></div>

<p>I had to go back and start from beginning because of new ideas how to aproach this. <code class="language-plaintext highlighter-rouge">⭴ſᕨ⒨આዃੀĎ⋆ସ⭴ſᕨ⒨</code> does a good job in prolonging the analysis, after a while I decided to remove it manually from the file, which decreased the size of a file from around 6.989KB to 1.022KB. I had default settings still in SublimeText which I’m using to analyze it, and I caught myself removing too large chunks which hid just a few variables without which the code wouldn’t compile. I decided to replace those chunks with some placeholder names. However now after removing those parts the code is indistinguasable, It just looks like a wall of text.</p>

<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre></td><td class="rouge-code"><pre>_0x3e2d -&gt; firstFunc (return 2 values)
_0x4813 -&gt; func2
_0x4721 -&gt; func3
_0x3413 -&gt; func4
_0x1091 -&gt; func5
_0x3fcb -&gt; func6



_0x1091ef -&gt; varF5
</pre></td></tr></tbody></table></code></div></div>

<p>firstFunc -&gt; uses func5()</p>

<p>func2 -&gt; uses func4()</p>

<p>func3 -&gt; uses firstFunc and func2</p>

<p>func4 -&gt; uses firstFunc</p>

<p>func5 -&gt; just holds cutted commands</p>

<p>func6 -&gt; uses func3()</p>

<div class="table-wrapper"><table>
  <thead>
    <tr>
      <th> </th>
      <th>firstFunc</th>
      <th>func2</th>
      <th>func3</th>
      <th>func4</th>
      <th>func5</th>
      <th>func6</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>firstFunc</td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td>X</td>
      <td> </td>
    </tr>
    <tr>
      <td>func2</td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td>X</td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>func3</td>
      <td>X</td>
      <td>X</td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>func4</td>
      <td>X</td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>func5</td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>func6</td>
      <td> </td>
      <td> </td>
      <td>X</td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
  </tbody>
</table></div>

<p>okay i was tinkering around for too long.</p>

<p>Order of executing the code:</p>
<ol>
  <li>firstFunc declared (uses func5)</li>
  <li>func2 declared (uses func4)</li>
  <li>func3 declared (uses firstFunc and func2)</li>
  <li>func4 declared (uses firstFunc)</li>
  <li>func5 declared</li>
  <li>func6 declared (uses func3)</li>
</ol>

<p>What methods are used by the JS code?
shift() - <code class="language-plaintext highlighter-rouge">The </code>shift()<code class="language-plaintext highlighter-rouge"> method in JavaScript removes the first element from an array and returns that element, while also changing the length of the array.</code>
replace() - replaces matched pattern
FileExists? -
length() - returns length of target array
Type
location.host? - <code class="language-plaintext highlighter-rouge">The </code>location.host<code class="language-plaintext highlighter-rouge"> property returns the host (IP adress or domain) and port of a URL. The </code>location.host<code class="language-plaintext highlighter-rouge"> property can also be set, to navigate to the same URL with a new host and port.</code>
event - its related to HTML events, as in this example on specific mouse interations
src - <code class="language-plaintext highlighter-rouge">The </code>src<code class="language-plaintext highlighter-rouge"> attribute specifies the URL of an external script file.</code>
modo ??
mousedown
mouseout
split() - similarly to replace(), it divides strings into array of substrings, so maybe the removed strings are important
href</p>

<p>text</p>

<p>protocol</p>

<p><code class="language-plaintext highlighter-rouge">આዃੀĎ⋆ସ⭴ſᕨ⒨</code>
E? <code class="language-plaintext highlighter-rouge">E[_0x138f04(0x21b)]=huyttara;</code></p>

<h3 id="summary"><span class="me-2">Summary</span><a href="#summary" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>
<h2 id="revision-history"><span class="me-2">Revision History</span><a href="#revision-history" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>
<ul>
  <li><strong>2025-07-17</strong>: Initial threat acquisition and research.</li>
  <li><strong>2025-09-05</strong>: Posting draft version of post.
&lt;!– - <strong>2025-07-17</strong>: Updated with detailed technical analysis and impact assessment.</li>
  <li><strong>2025-07-17</strong>: Final review and development of response strategies. –&gt;</li>
</ul>

  </div>

  <div class="post-tail-wrapper text-muted">
    <!-- categories -->
    

    <!-- tags -->
    
      <div class="post-tags">
        <i class="fa fa-tags fa-fw me-1"></i>
        
          <a
            href="/tags/malware/"
            class="post-tag no-text-decoration"
          >malware</a>
        
          <a
            href="/tags/dbatloader/"
            class="post-tag no-text-decoration"
          >DBatLoader</a>
        
          <a
            href="/tags/js/"
            class="post-tag no-text-decoration"
          >JS</a>
        
          <a
            href="/tags/dhl/"
            class="post-tag no-text-decoration"
          >DHL</a>
        
      </div>
    

    <div
      class="
        post-tail-bottom
        d-flex justify-content-between align-items-center mt-5 pb-2
      "
    >
      <div class="license-wrapper">
        
          

          This post is licensed under 
        <a href="https://creativecommons.org/licenses/by/4.0/">
          CC BY 4.0
        </a>
         by the author.
        
      </div>

      <!-- Post sharing snippet -->

<div class="share-wrapper d-flex align-items-center">
  <span class="share-label text-muted">Share</span>
  <span class="share-icons">
    
    
    

    

      

      <a href="https://twitter.com/intent/tweet?text=DBatLoader%20-%20Malware%20Analysis%20Walkthrough%20-%20Qba01&url=http%3A%2F%2Flocalhost%3A4000%2Fposts%2FDBatLoader%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Twitter" aria-label="Twitter">
        <i class="fa-fw fa-brands fa-square-x-twitter"></i>
      </a>
    

      

      <a href="https://www.reddit.com/submit?url=http%3A%2F%2Flocalhost%3A4000%2Fposts%2FDBatLoader%2F&title=DBatLoader%20-%20Malware%20Analysis%20Walkthrough%20-%20Qba01" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Reddit" aria-label="Reddit">
        <i class="fa-fw fa-brands fa-square-reddit"></i>
      </a>
    

    <button
      id="copy-link"
      aria-label="Copy link"
      class="btn small"
      data-bs-toggle="tooltip"
      data-bs-placement="top"
      title="Copy link"
      data-title-succeed="Link copied successfully!"
    >
      <i class="fa-fw fas fa-link pe-none fs-6"></i>
    </button>
  </span>
</div>

    </div>
    <!-- .post-tail-bottom -->
  </div>
  <!-- div.post-tail-wrapper -->
</article>


            
          </main>

          <!-- panel -->
          <aside aria-label="Panel" id="panel-wrapper" class="col-xl-3 ps-2 text-muted">
            <div class="access">
              <!-- Get 5 last posted/updated posts -->














  <section id="access-lastmod">
    <h2 class="panel-heading">Recently Updated</h2>
    <ul class="content list-unstyled ps-0 pb-1 ms-1 mt-2">
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/KoiLoader/">KoiLoader - Malware Analysis Walkthrough</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/DBatLoader/">DBatLoader - Malware Analysis Walkthrough</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/First-post/">First post</a>
        </li>
      
    </ul>
  </section>
  <!-- #access-lastmod -->


              <!-- The trending tags list -->















  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        



  <section>
    <h2 class="panel-heading">Trending Tags</h2>
    <div class="d-flex flex-wrap mt-3 mb-1 me-3">
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/malware/">malware</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/dbatloader/">DBatLoader</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/dhl/">DHL</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/js/">JS</a>
      
    </div>
  </section>


            </div>

            
              
              






  <div class="toc-border-cover z-3"></div>
  <section id="toc-wrapper" class="invisible position-sticky ps-0 pe-4 pb-4">
    <h2 class="panel-heading ps-3 pb-2 mb-0">Contents</h2>
    <nav id="toc"></nav>
  </section>


            
          </aside>
        </div>

        <div class="row">
          <!-- tail -->
          <div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 px-md-4">
            
              
              <!-- Recommend the other 3 posts according to the tags and categories of the current post. -->

<!-- The total size of related posts -->


<!-- An random integer that bigger than 0 -->


<!-- Equals to TAG_SCORE / {max_categories_hierarchy} -->















  

  
    
  

  

  

  

  

  











  <aside id="related-posts" aria-labelledby="related-label">
    <h3 class="mb-4" id="related-label">Further Reading</h3>
    <nav class="row row-cols-1 row-cols-md-2 row-cols-xl-3 g-4 mb-4">
      
        <article class="col">
          <a href="/posts/KoiLoader/" class="post-preview card h-100">
            <div class="card-body">
              <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1753999200"
  data-df="ll"
  
>
  Aug  1, 2025
</time>

              <h4 class="pt-0 my-2">KoiLoader - Malware Analysis Walkthrough</h4>
              <div class="text-muted">
                <p>This is still kind of a draft version of the post. However I wanted to post it so I can show snippet of what I’m doing. The markdown composition as well as the finall template of the report is also...</p>
              </div>
            </div>
          </a>
        </article>
      
    </nav>
  </aside>
  <!-- #related-posts -->


            
              
              <!-- Navigation buttons at the bottom of the post. -->

<nav class="post-navigation d-flex justify-content-between" aria-label="Post Navigation">
  
  

  
    <a
      href="/posts/First-post/"
      class="btn btn-outline-primary"
      aria-label="Older"
    >
      <p>First post</p>
    </a>
  

  
    <a
      href="/posts/KoiLoader/"
      class="btn btn-outline-primary"
      aria-label="Newer"
    >
      <p>KoiLoader - Malware Analysis Walkthrough</p>
    </a>
  
</nav>

            

            <!-- The Footer -->

<footer
  aria-label="Site Info"
  class="
    d-flex flex-column justify-content-center text-muted
    flex-lg-row justify-content-lg-between align-items-lg-center pb-lg-3
  "
>
  <p>©
    <time>2025</time>

    
      <a href="https://github.com/Qba01">Qba01</a>.
    

    
      <span
        data-bs-toggle="tooltip"
        data-bs-placement="top"
        title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author."
      >Some rights reserved.</span>
    
  </p>

  <p>Using the <a
        data-bs-toggle="tooltip"
        data-bs-placement="top"
        title="v7.3.0"
        href="https://github.com/cotes2020/jekyll-theme-chirpy"
        target="_blank"
        rel="noopener"
      >Chirpy</a> theme for <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a>.
  </p>
</footer>

          </div>
        </div>

        <!-- The Search results -->

<div id="search-result-wrapper" class="d-flex justify-content-center d-none">
  <div class="col-11 content">
    <div id="search-hints">
      <!-- The trending tags list -->















  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        



  <section>
    <h2 class="panel-heading">Trending Tags</h2>
    <div class="d-flex flex-wrap mt-3 mb-1 me-3">
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/malware/">malware</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/dbatloader/">DBatLoader</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/dhl/">DHL</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/js/">JS</a>
      
    </div>
  </section>


    </div>
    <div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div>
  </div>
</div>

      </div>

      <aside aria-label="Scroll to Top">
        <button id="back-to-top" type="button" class="btn btn-lg btn-box-shadow">
          <i class="fas fa-angle-up"></i>
        </button>
      </aside>
    </div>

    <div id="mask" class="d-none position-fixed w-100 h-100 z-1"></div>

    
      <aside
  id="notification"
  class="toast"
  role="alert"
  aria-live="assertive"
  aria-atomic="true"
  data-bs-animation="true"
  data-bs-autohide="false"
>
  <div class="toast-header">
    <button
      type="button"
      class="btn-close ms-auto"
      data-bs-dismiss="toast"
      aria-label="Close"
    ></button>
  </div>
  <div class="toast-body text-center pt-0">
    <p class="px-2 mb-3">A new version of content is available.</p>
    <button type="button" class="btn btn-primary" aria-label="Update">
      Update
    </button>
  </div>
</aside>

    

    <!-- Embedded scripts -->

    
      
      <!-- The comments switcher -->


    

    <!--
  Jekyll Simple Search loader
  See: <https://github.com/christian-fei/Simple-Jekyll-Search>
-->





<script>
  
  document.addEventListener('DOMContentLoaded', () => {
    SimpleJekyllSearch({
      searchInput: document.getElementById('search-input'),
      resultsContainer: document.getElementById('search-results'),
      json: '/assets/js/data/search.json',
      searchResultTemplate: '  <article class="px-1 px-sm-2 px-lg-4 px-xl-0">    <header>      <h2><a href="{url}">{title}</a></h2>      <div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1">        {categories}        {tags}      </div>    </header>    <p>{content}</p>  </article>',
      noResultsText: '<p class="mt-5">Oops! No results found.</p>',
      templateMiddleware: function(prop, value, template) {
        if (prop === 'categories') {
          if (value === '') {
            return `${value}`;
          } else {
            return `<div class="me-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`;
          }
        }

        if (prop === 'tags') {
          if (value === '') {
            return `${value}`;
          } else {
            return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`;
          }
        }
      }
    });
  });
</script>

  </body>
</html>

